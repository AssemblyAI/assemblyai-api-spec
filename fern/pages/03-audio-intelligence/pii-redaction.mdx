---
title: "PII Redaction"
description: "Redact PII that is spoken in your audio"
---

import { LanguageTable } from "../../assets/components/LanguagesTable";

<AccordionGroup>

<Accordion title="Supported languages">
  <LanguageTable
    languages={[
      { name: "Global English", code: "en" },
      { name: "Australian English", code: "en_au" },
      { name: "British English", code: "en_uk" },
      { name: "US English", code: "en_us" },
      { name: "Spanish", code: "es" },
      { name: "French", code: "fr" },
      { name: "German", code: "de" },
      { name: "Italian", code: "it" },
      { name: "Portuguese", code: "pt" },
      { name: "Dutch", code: "nl" },
      { name: "Hindi", code: "hi" },
      { name: "Japanese", code: "ja" },
      { name: "Chinese", code: "zh" },
      { name: "Finnish", code: "fi" },
      { name: "Korean", code: "ko" },
      { name: "Polish", code: "pl" },
      { name: "Russian", code: "ru" },
      { name: "Turkish", code: "tr" },
      { name: "Ukrainian", code: "uk" },
      { name: "Vietnamese", code: "vi" },
      { name: "Afrikaans", code: "af" },
      { name: "Arabic", code: "ar" },
      { name: "Belarusian", code: "be" },
      { name: "Bulgarian", code: "bg" },
      { name: "Burmese", code: "my" },
      { name: "Catalan", code: "ca" },
      { name: "Croatian", code: "hr" },
      { name: "Czech", code: "cs" },
      { name: "Danish", code: "da" },
      { name: "Estonian", code: "et" },
      { name: "Georgian", code: "ka" },
      { name: "Greek", code: "el" },
      { name: "Hebrew", code: "he" },
      { name: "Hungarian", code: "hu" },
      { name: "Icelandic", code: "is" },
      { name: "Indonesian", code: "id" },
      { name: "Khmer", code: "km" },
      { name: "Latvian", code: "lv" },
      { name: "Lithuanian", code: "lt" },
      { name: "Luxembourgish", code: "lb" },
      { name: "Malay", code: "ms" },
      { name: "Norwegian", code: "no" },
      { name: "Persian", code: "fa" },
      { name: "Romanian", code: "ro" },
      { name: "Slovak", code: "sk" },
      { name: "Slovenian", code: "sl" },
      { name: "Swahili", code: "sw" },
      { name: "Swedish", code: "sv" },
      { name: "Tagalog", code: "tl" },
      { name: "Tamil", code: "ta" },
    ]}
    columns={4}
  />
  <br />
</Accordion>

<Accordion title="Supported models">
  <LanguageTable
    languages={[
      { name: "Slam-1", code: "slam-1" },
      { name: "Universal", code: "universal" },
    ]}
    columns={2}
  />
  <br />
</Accordion>

<Accordion title="Supported regions">US & EU</Accordion>

</AccordionGroup>

The PII Redaction model lets you minimize sensitive information about individuals by automatically identifying and removing it from your transcript.

Personal Identifiable Information (PII) is any information that can be used to identify a person, such as a name, email address, or phone number.

When you enable the PII Redaction model, your transcript will look like this:

- With `hash` substitution: `Hi, my name is ####!`
- With `entity_name` substitution: `Hi, my name is [PERSON_NAME]!`

You can also [Create redacted audio files](#create-redacted-audio-files) to replace sensitive information with a beeping sound.

<Warning title="Redacted Properties">
  PII only redacts words in the `text` property. Properties from other features
  may still include PII, such as `entities` from [Entity
  Detection](/docs/audio-intelligence/entity-detection) or `summary` from
  [Summarization](/docs/audio-intelligence/summarization).
</Warning>

## Quickstart

<Tabs groupId="language">
  <Tab language="python-sdk" title="Python SDK" default>
  Enable PII Redaction on the `TranscriptionConfig` using the `set_redact_pii()`
method.

Set `policies` to specify the information you want to redact. For the full list of policies, see [PII policies](#pii-policies).

```python {8-15}
import assemblyai as aai

aai.settings.api_key = "<YOUR_API_KEY>"

# audio_file = "./local_file.mp3"
audio_file = "https://assembly.ai/wildfires.mp3"

config = aai.TranscriptionConfig().set_redact_pii(
    policies=[
        aai.PIIRedactionPolicy.person_name,
        aai.PIIRedactionPolicy.organization,
        aai.PIIRedactionPolicy.occupation,
    ],
    substitution=aai.PIISubstitutionPolicy.hash,
)

transcript = aai.Transcriber().transcribe(audio_file, config)
print(f"Transcript ID:", transcript.id)

print(transcript.text)
```

  </Tab>
  <Tab language="python" title="Python" default>
  
  Enable Topic Detection by setting `redact_pii` to `True` in the JSON payload.

Set `redact_pii_policies` to specify the information you want to redact. For the full list of policies, see [PII policies](#pii-policies).

Set `redact_pii_sub` to specify the replacement for redacted information.

```python {19-21}
import requests
import time

base_url = "https://api.assemblyai.com"

headers = {
    "authorization": "<YOUR_API_KEY>"
}

with open("./local_file.mp3", "rb") as f:
    response = requests.post(base_url + "/v2/upload",
                            headers=headers,
                            data=f)

upload_url = response.json()["upload_url"]

data = {
    "audio_url": upload_url, # You can also use a URL to an audio or video file on the web
    "redact_pii": True,
    "redact_pii_policies": ["person_name", "organization", "occupation"],
    "redact_pii_sub": "hash"
}

url = base_url + "/v2/transcript"
response = requests.post(url, json=data, headers=headers)

transcript_id = response.json()['id']
polling_endpoint = base_url + "/v2/transcript/" + transcript_id

print(f"Transcript ID:", transcript_id)

while True:
    transcription_result = requests.get(polling_endpoint, headers=headers).json()

    if transcription_result['status'] == 'completed':
        print(transcription_result['text'])
        break
    elif transcription_result['status'] == 'error':
        raise RuntimeError(f"Transcription failed: {transcription_result['error']}")
    else:
        time.sleep(3)
```

  </Tab>
  <Tab language="javascript-sdk" title="JavaScript SDK">
  
  Enable PII Redaction by setting `redact_pii` to `true` in the transcription
config.

Use `redact_pii_policies` to specify the information you want to
redact. For the full list of policies, see [PII policies](#pii-policies).

```javascript {12-14}
import { AssemblyAI } from "assemblyai";

const client = new AssemblyAI({
  apiKey: "<YOUR_API_KEY>",
});

// const audioFile = './local_file.mp3'
const audioFile = "https://assembly.ai/wildfires.mp3";

const params: TranscribeParams = {
  audio: audioFile,
  redact_pii: true,
  redact_pii_policies: ["person_name", "organization", "occupation"],
  redact_pii_sub: "hash",
};

const run = async () => {
  const transcript = await client.transcripts.transcribe(params);

  console.log(transcript.text);
};

run();
```

  </Tab>
  <Tab language="javascript" title="JavaScript">
  
    Enable Topic Detection by setting `redact_pii` to `true` in the JSON payload.

Set `redact_pii_policies` to specify the information you want to redact. For the full list of policies, see [PII policies](#pii-policies).

Set `redact_pii_sub` to specify the replacement for redacted information.

```javascript {19-21}
import axios from "axios";
import fs from "fs-extra";

const baseUrl = "https://api.assemblyai.com";

const headers = {
  authorization: "<YOUR_API_KEY>",
};

const path = "./my-audio.mp3";
const audioData = await fs.readFile(path);
const uploadResponse = await axios.post(`${baseUrl}/v2/upload`, audioData, {
  headers,
});
const uploadUrl = uploadResponse.data.upload_url;

const data = {
  audio_url: uploadUrl, // You can also use a URL to an audio or video file on the web
  redact_pii: true,
  redact_pii_policies: ["person_name", "organization", "occupation"],
  redact_pii_sub: "hash",
};

const url = `${baseUrl}/v2/transcript`;
const response = await axios.post(url, data, { headers: headers });

const transcriptId = response.data.id;
console.log("Transcript ID: ", transcriptId);

const pollingEndpoint = `${baseUrl}/v2/transcript/${transcriptId}`;

while (true) {
  const pollingResponse = await axios.get(pollingEndpoint, {
    headers: headers,
  });
  const transcriptionResult = pollingResponse.data;

  if (transcriptionResult.status === "completed") {
    console.log(transcriptionResult.text);
    break;
  } else if (transcriptionResult.status === "error") {
    throw new Error(`Transcription failed: ${transcriptionResult.error}`);
  } else {
    await new Promise((resolve) => setTimeout(resolve, 3000));
  }
}
```

  </Tab>
  <Tab language="csharp" title="C#">
  
  Enable Topic Detection by setting `redact_pii` to `true` in the JSON payload.

Set `redact_pii_policies` to specify the information you want to redact. For the full list of policies, see [PII policies](#pii-policies).

Set `redact_pii_sub` to specify the replacement for redacted information.

<Info>
  Most of these libraries are included by default, but on .NET Framework and
  Mono you need to reference the System.Net.Http library and install the
  [System.Net.Http.Json NuGet
  package](https://www.nuget.org/packages/System.Net.Http.Json).
</Info>

```csharp {53-55}
using System;
using System.IO;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Net.Http.Json;
using System.Text;
using System.Text.Json;
using System.Threading.Tasks;
using System.Text.Json.Serialization;
using System.Collections.Generic;

class Program
{
    static async Task Main(string[] args)
    {
        string baseUrl = "https://api.assemblyai.com";

        using (var httpClient = new HttpClient())
        {
            httpClient.DefaultRequestHeaders.Authorization =
                new AuthenticationHeaderValue("<YOUR_API_KEY>");

            string uploadUrl = await UploadFileAsync("./local_file.mp3", httpClient, baseUrl);

            var transcript = await CreateTranscriptWithPiiRedactionAsync(uploadUrl, httpClient, baseUrl);

            Console.WriteLine($"Transcript ID: {transcript.Id}");
            transcript = await WaitForTranscriptToProcessAndGetRedactedText(transcript, httpClient, baseUrl);
        }
    }

    static async Task<string> UploadFileAsync(string filePath, HttpClient httpClient, string baseUrl)
    {
        using (var fileStream = File.OpenRead(filePath))
        using (var fileContent = new StreamContent(fileStream))
        {
            fileContent.Headers.ContentType = new MediaTypeHeaderValue("application/octet-stream");

            using (var response = await httpClient.PostAsync($"{baseUrl}/v2/upload", fileContent))
            {
                response.EnsureSuccessStatusCode();
                var jsonDoc = await response.Content.ReadFromJsonAsync<JsonDocument>();
                return jsonDoc.RootElement.GetProperty("upload_url").GetString();
            }
        }
    }

    static async Task<Transcript> CreateTranscriptWithPiiRedactionAsync(string audioUrl, HttpClient httpClient, string baseUrl)
    {
        var data = new
        {
            audio_url = audioUrl,
            redact_pii = true,
            redact_pii_policies = new[] { "person_name", "organization", "occupation" },
            redact_pii_sub = "hash"
        };

        var content = new StringContent(JsonSerializer.Serialize(data), Encoding.UTF8, "application/json");

        using (var response = await httpClient.PostAsync($"{baseUrl}/v2/transcript", content))
        {
            response.EnsureSuccessStatusCode();
            return await response.Content.ReadFromJsonAsync<Transcript>();
        }
    }

    static async Task<Transcript> WaitForTranscriptToProcessAndGetRedactedText(Transcript transcript, HttpClient httpClient, string baseUrl)
    {
        string pollingEndpoint = $"{baseUrl}/v2/transcript/{transcript.Id}";

        while (true)
        {
            var pollingResponse = await httpClient.GetAsync(pollingEndpoint);
            transcript = await pollingResponse.Content.ReadFromJsonAsync<Transcript>();

            switch (transcript.Status)
            {
                case "completed":
                    // Print the redacted transcript text
                    Console.WriteLine(transcript.Text);
                    return transcript;

                case "error":
                    throw new Exception($"Transcription failed: {transcript.Error}");

                default:
                    await Task.Delay(TimeSpan.FromSeconds(3));
                    break;
            }
        }
    }

    public class Transcript
    {
        [JsonPropertyName("id")]
        public string Id { get; set; }

        [JsonPropertyName("status")]
        public string Status { get; set; }

        [JsonPropertyName("text")]
        public string Text { get; set; }

        [JsonPropertyName("error")]
        public string Error { get; set; }
    }
}
```

  </Tab>
<Tab language="ruby" title="Ruby">
  
  Enable Topic Detection by setting `redact_pii` to `true` in the JSON payload.

Set `redact_pii_policies` to specify the information you want to redact. For the full list of policies, see [PII policies](#pii-policies).

Set `redact_pii_sub` to specify the replacement for redacted information.

```ruby {23-25}
require 'net/http'
require 'json'

base_url = 'https://api.assemblyai.com'

headers = {
  'authorization' => '<YOUR_API_KEY>',
  'content-type' => 'application/json'
}

path = "/my_audio.mp3"
uri = URI("#{base_url}/v2/upload")
request = Net::HTTP::Post.new(uri, headers)
request.body = File.read(path)

http = Net::HTTP.new(uri.host, uri.port)
http.use_ssl = true
upload_response = http.request(request)
upload_url = JSON.parse(upload_response.body)["upload_url"]

data = {
    "audio_url" => upload_url, # You can also use a URL to an audio or video file on the web
    "redact_pii" => true,
    "redact_pii_policies" => ["person_name", "organization", "occupation"],
    "redact_pii_sub" => "hash"
}

uri = URI.parse("#{base_url}/v2/transcript")
http = Net::HTTP.new(uri.host, uri.port)
http.use_ssl = true

request = Net::HTTP::Post.new(uri.request_uri, headers)
request.body = data.to_json

response = http.request(request)
response_body = JSON.parse(response.body)

raise "API request failed with status #{response.code}: #{response.body}" unless response.is_a?(Net::HTTPSuccess)

transcript_id = response_body['id']
puts "Transcript ID: #{transcript_id}"

polling_endpoint = URI.parse("#{base_url}/v2/transcript/#{transcript_id}")

while true
  polling_http = Net::HTTP.new(polling_endpoint.host, polling_endpoint.port)
  polling_http.use_ssl = true
  polling_request = Net::HTTP::Get.new(polling_endpoint.request_uri, headers)
  polling_response = polling_http.request(polling_request)

  transcription_result = JSON.parse(polling_response.body)

  if transcription_result['status'] == 'completed'
    puts transcription_result['text']
  break
  elsif transcription_result['status'] == 'error'
    raise "Transcription failed: #{transcription_result['error']}"
  else
    sleep(3)
  end
end
```

  </Tab>
  <Tab language="php" title="PHP">
  
    Enable Topic Detection by setting `redact_pii` to `true` in the JSON payload.

Set `redact_pii_policies` to specify the information you want to redact. For the full list of policies, see [PII policies](#pii-policies).

Set `redact_pii_sub` to specify the replacement for redacted information.

```php {30-32}
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$base_url = "https://api.assemblyai.com";

$headers = array(
    "authorization: <YOUR_API_KEY>",
    "content-type: application/json"
);

$path = "./my-audio.mp3";

$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, $base_url . "/v2/upload");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, file_get_contents($path));
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

$response = curl_exec($ch);
$response_data = json_decode($response, true);
$upload_url = $response_data["upload_url"];

curl_close($ch);

$data = array(
    "audio_url" => $upload_url, // You can also use a URL to an audio or video file on the web
    "redact_pii" => true,
    "redact_pii_policies" => ["person_name", "organization", "occupation"],
    "redact_pii_sub" => "hash"
);
$url = $base_url . "/v2/transcript";
$curl = curl_init($url);

curl_setopt($curl, CURLOPT_POST, true);
curl_setopt($curl, CURLOPT_POSTFIELDS, json_encode($data));
curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);

$response = curl_exec($curl);

$response = json_decode($response, true);

curl_close($curl);

$transcript_id = $response['id'];
echo "Transcript ID: $transcript_id\n";

$polling_endpoint = $base_url . "/v2/transcript/" . $transcript_id;

while (true) {
    $polling_response = curl_init($polling_endpoint);

    curl_setopt($polling_response, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($polling_response, CURLOPT_RETURNTRANSFER, true);

    $transcription_result = json_decode(curl_exec($polling_response), true);

    if ($transcription_result['status'] === "completed") {
        echo $transcription_result['text'] . "\n";
        break;
    }  else if ($transcription_result['status'] === "error") {
        throw new Exception("Transcription failed: " . $transcription_result['error']);
    } else {
        sleep(3);
    }
}
```

  </Tab>
</Tabs>

### Example output

```plain
Smoke from hundreds of wildfires in Canada is triggering air quality alerts
throughout the US. Skylines from Maine to Maryland to Minnesota are gray and
smoggy. And in some places, the air quality warnings include the warning to stay
inside. We wanted to better understand what's happening here and why, so we
called ##### #######, an ######### ######### in the ########## ## #############
###### ### ########### at ##### ####### ##########. Good morning, #########.
Good morning. So what is it about the conditions right now that have caused this
round of wildfires to affect so many people so far away? Well, there's a couple
of things. The season has been pretty dry already, and then the fact that we're
getting hit in the US. Is because there's a couple of weather systems that ...
```

<Tip title="PII Redaction Using LeMUR">
  If you would like the option to use LeMUR for custom PII redaction, check out
  this guide [Redact PII from Text Using
  LeMUR](/docs/lemur/lemur-pii-redaction).
</Tip>

## Create redacted audio files

In addition to redacting sensitive information from the transcription text, you can also generate a version of the original audio file with the PII "beeped" out.

<Tip title="Redacted Audio Endpoint">

Retrieve the redacted audio file using the `transcript_id` for a transcript where `redact_pii_audio` was enabled during submission:

<EndpointRequestSnippet endpoint="GET /v2/transcript/:transcript_id/redacted-audio" />

</Tip>

<Note title="Webhooks and PII Audio Redaction">

If using webhooks with PII audio redaction enabled, you'll receive two webhook calls: the first when the redacted audio file is ready and the second when the request for transcription is completed. For more information about using webhooks, refer to our [webhook documentation](/docs/deployment/webhooks).

</Note>

<Tabs groupId="language">
  <Tab value="python-sdk" title="Python SDK" default>
    To create a redacted version of the audio file, use the `set_redact_pii()` method on the `TranscriptionConfig` with `redact_audio` to `True`.

Use `get_redacted_audio_url()` on the transcript to get the URL to the redacted audio file.

```python {7,12}
config = aai.TranscriptionConfig().set_redact_pii(
    policies=[
        aai.PIIRedactionPolicy.person_name,
        aai.PIIRedactionPolicy.organization,
        aai.PIIRedactionPolicy.occupation,
    ],
    redact_audio=True
)

transcript = aai.Transcriber().transcribe(audio_url, config)

print(transcript.get_redacted_audio_url())
```

  </Tab>
  <Tab value="python" title="Python" default>
    To create a redacted version of the audio file, set `redact_pii_audio` to `True` on the JSON payload.
    Set `redact_pii_audio_quality` to specify the quality of the redacted audio file.

Use the transcript ID to poll the [GET redacted audio endpoint](/docs/api-reference/transcripts/get-redacted-audio) every few seconds to check the status of the redacted audio. Once the status is `redacted_audio_ready`, you can retrieve the audio URL from the API response.

```python {6-7,11-22}
data = {
    "audio_url": upload_url, # You can also use a URL to an audio or video file on the web
    "redact_pii": True,
    "redact_pii_policies": ["person_name", "organization", "occupation"],
    "redact_pii_sub": "hash",
    "redact_pii_audio": True,
    "redact_pii_audio_quality": "wav" # Optional. Defaults to "mp3"
}

# ...
redacted_audio_polling_endpoint = base_url + "/v2/transcript/" + transcript_id + "/redacted-audio"

while True:
    redacted_audio_result = requests.get(redacted_audio_polling_endpoint, headers=headers).json()

    if redacted_audio_result['status'] == 'redacted_audio_ready':
        print(redacted_audio_result['redacted_audio_url'])
        break
    elif redacted_audio_result['status'] == 'error':
        raise RuntimeError(f"Transcription failed: {redacted_audio_result['error']}")
    else:
        time.sleep(3)
```

  </Tab>
  <Tab language="javascript-sdk" title="JavaScript SDK">

To create a redacted version of the audio file, set `redact_pii_audio` to
`true` in the transcription config. Use `redact_pii_audio_quality` to specify
the quality of the redacted audio file.

Use redactedAudio() on the transcript to get the URL to the redacted audio file.

```javascript {5-6, 12-14}
const params: TranscribeParams = {
  audio: audioUrl,
  redact_pii: true,
  redact_pii_policies: ["person_name", "organization", "occupation"],
  redact_pii_audio: true,
  redact_pii_audio_quality: "wav", // Optional. Defaults to "mp3"
};

const run = async () => {
  const transcript = await client.transcripts.transcribe(params);

  const { status, redacted_audio_url } = await client.transcripts.redactedAudio(
    transcript.id
  );

  console.log(`Status: ${status}, Redacted audio URL: ${redacted_audio_url}`);
};

run();
```

You can also retrieve the redacted audio file itself using `redactedAudioFile()`.
The following code writes the redacted audio file to a local file, using `writeFile()` from Node.js.

```javascript
import fs from "fs/promises";

...

const audioFile = await client.transcripts.redactedAudioFile(transcript.id);
await fs.writeFile('./redacted-audio.wav', audioFile.body, 'binary');
```

  </Tab>
  <Tab value="javascript" title="JavaScript" default>
    To create a redacted version of the audio file, set `redact_pii_audio` to `true` on the JSON payload.
    Set `redact_pii_audio_quality` to specify the quality of the redacted audio file.

Use the transcript ID to poll the [GET redacted audio endpoint](/docs/api-reference/transcripts/get-redacted-audio) every few seconds to check the status of the redacted audio. Once the status is `redacted_audio_ready`, you can retrieve the audio URL from the API response.

```javascript {6-7,11,14-26}
const data = {
  audio_url: uploadUrl, // You can also use a URL to an audio or video file on the web
  redact_pii: true,
  redact_pii_policies: ["person_name", "organization", "occupation"],
  redact_pii_sub: "hash",
  redact_pii_audio: true,
  redact_pii_audio_quality: "wav", // Optional. Defaults to "mp3"
};

// ...
const redactedAudioPollingEndpoint = `${baseUrl}/v2/transcript/${transcriptId}/redacted-audio`;

while (true) {
  const redactedAudioPollingResponse = await axios.get(
    redactedAudioPollingEndpoint,
    {
      headers: headers,
    }
  );
  const redactedAudioResult = redactedAudioPollingResponse.data;

  if (redactedAudioResult.status === "redacted_audio_ready") {
    console.log(redactedAudioResult.redacted_audio_url);
    break;
  } else if (redactedAudioResult.status === "error") {
    throw new Error(`Transcription failed: ${redactedAudioResult.error}`);
  } else {
    await new Promise((resolve) => setTimeout(resolve, 3000));
  }
}
```

  </Tab>
  <Tab value="csharp" title="C#" default>
    To create a redacted version of the audio file, set `redact_pii_audio` to `true` on the JSON payload.
    Set `redact_pii_audio_quality` to specify the quality of the redacted audio file.

Use the transcript ID to poll the [GET redacted audio endpoint](/docs/api-reference/transcripts/get-redacted-audio) every few seconds to check the status of the redacted audio. Once the status is `redacted_audio_ready`, you can retrieve the audio URL from the API response.

```csharp {7-8,29,35-63,67-77}
var data = new
{
    audio_url = audioUrl,
    redact_pii = true,
    redact_pii_policies = new[] { "person_name", "organization", "occupation" },
    redact_pii_sub = "hash",
    redact_pii_audio = true,
    redact_pii_audio_quality = "wav" // Optional. Defaults to "mp3"
};

// ...
  static async Task Main(string[] args)
  {
      string baseUrl = "https://api.assemblyai.com";

      using (var httpClient = new HttpClient())
      {
          httpClient.DefaultRequestHeaders.Authorization =
              new AuthenticationHeaderValue("<YOUR_API_KEY>");

          string uploadUrl = await UploadFileAsync("./local_file.mp3", httpClient, baseUrl);

          var transcript = await CreateTranscriptWithPiiRedactionAsync(uploadUrl, httpClient, baseUrl);

          Console.WriteLine($"Transcript ID: {transcript.Id}");
          transcript = await WaitForTranscriptToProcessAndGetRedactedText(transcript, httpClient, baseUrl);

          // Wait for the redacted audio
          string redactedAudioUrl = await WaitForRedactedAudioAsync(transcript.Id, httpClient, baseUrl);
      }
  }

// ...

static async Task<string> WaitForRedactedAudioAsync(string transcriptId, HttpClient httpClient, string baseUrl)
{
    string redactedAudioPollingEndpoint = $"{baseUrl}/v2/transcript/{transcriptId}/redacted-audio";

    while (true)
    {
        var pollingResponse = await httpClient.GetAsync(redactedAudioPollingEndpoint);
        var responseContent = await pollingResponse.Content.ReadAsStringAsync();

        var redactedAudioResult = JsonSerializer.Deserialize<RedactedAudioResult>(
            responseContent,
            new JsonSerializerOptions { PropertyNameCaseInsensitive = true }
        );

        if (redactedAudioResult.Status == "redacted_audio_ready")
        {
            Console.WriteLine(redactedAudioResult.RedactedAudioUrl);
            return redactedAudioResult.RedactedAudioUrl;
        }
        else if (redactedAudioResult.Status == "error")
        {
            throw new Exception($"Redacted audio failed: {redactedAudioResult.Error}");
        }
        else
        {
            await Task.Delay(TimeSpan.FromSeconds(3));
        }
    }
}

// ...

public class RedactedAudioResult
{
    [JsonPropertyName("status")]
    public string Status { get; set; }

    [JsonPropertyName("redacted_audio_url")]
    public string RedactedAudioUrl { get; set; }

    [JsonPropertyName("error")]
    public string Error { get; set; }
}
```

  </Tab>
  <Tab value="ruby" title="Ruby" default>
    To create a redacted version of the audio file, set `redact_pii_audio` to `true` on the JSON payload.
    Set `redact_pii_audio_quality` to specify the quality of the redacted audio file.

Use the transcript ID to poll the [GET redacted audio endpoint](/docs/api-reference/transcripts/get-redacted-audio) every few seconds to check the status of the redacted audio. Once the status is `redacted_audio_ready`, you can retrieve the audio URL from the API response.

```ruby {6-7,11,14-28}
data = {
    "audio_url" => upload_url, # You can also use a URL to an audio or video file on the web
    "redact_pii" => true,
    "redact_pii_policies" => ["person_name", "organization", "occupation"],
    "redact_pii_sub" => "hash",
    "redact_pii_audio" => true,
    "redact_pii_audio_quality" => "wav" # Optional. Defaults to "mp3"
}

# ...
redacted_audio_polling_endpoint = URI.parse("#{base_url}/v2/transcript/#{transcript_id}/redacted-audio")

while true
  redacted_audio_polling_http = Net::HTTP.new(redacted_audio_polling_endpoint.host, redacted_audio_polling_endpoint.port)
  redacted_audio_polling_http.use_ssl = true
  redact_audio_polling_request = Net::HTTP::Get.new(redacted_audio_polling_endpoint.request_uri, headers)
  redacted_audio_polling_response = redacted_audio_polling_http.request(redact_audio_polling_request)

  redacted_audio_result = JSON.parse(redacted_audio_polling_response.body)

  if redacted_audio_result['status'] == 'redacted_audio_ready'
    puts redacted_audio_result['redacted_audio_url']
  break
  elsif redacted_audio_result['status'] == 'error'
    raise "Transcription failed: #{redacted_audio_result['error']}"
  else
    sleep(3)
  end
end
```

  </Tab>
    <Tab value="php" title="PHP" default>
    To create a redacted version of the audio file, set `redact_pii_audio` to `true` on the JSON payload.
    Set `redact_pii_audio_quality` to specify the quality of the redacted audio file.

Use the transcript ID to poll the [GET redacted audio endpoint](/docs/api-reference/transcripts/get-redacted-audio) every few seconds to check the status of the redacted audio. Once the status is `redacted_audio_ready`, you can retrieve the audio URL from the API response.

```php {6-7,11,14-28}
$data = array(
    "audio_url" => $upload_url, // You can also use a URL to an audio or video file on the web
    "redact_pii" => true,
    "redact_pii_policies" => ["person_name", "organization", "occupation"],
    "redact_pii_sub" => "hash",
    "redact_pii_audio" => true,
    "redact_pii_audio_quality" => "wav" // Optional. Defaults to "mp3"
);

# ...
$redacted_audio_polling_endpoint = $base_url . "/v2/transcript/" . $transcript_id . "/redacted-audio";

while (true) {
    $redacted_audio_polling_response = curl_init($redacted_audio_polling_endpoint);

    curl_setopt($redacted_audio_polling_response, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($redacted_audio_polling_response, CURLOPT_RETURNTRANSFER, true);

    $redacted_audio_result = json_decode(curl_exec($redacted_audio_polling_response), true);

    if ($redacted_audio_result['status'] === "redacted_audio_ready") {
        echo $redacted_audio_result['redacted_audio_url'] . "\n";
        break;
    }  else if ($redacted_audio_result['status'] === "error") {
        throw new Exception("Transcription failed: " . $redacted_audio_result['error']);
    } else {
        sleep(3);
    }
}
```

  </Tab>
</Tabs>

<Warning title="Maximum Audio File Size">
  You can only create redacted versions of audio files if the original file is
  smaller than 1 GB.
</Warning>

<Info title="Redacted Audio for Silent Files">
By default, audio redaction provides redacted audio URLs only when speech is detected. However, if your use-case specifically requires redacted audio files even for silent audio files without any dialogue, you can now opt to receive these URLs. Enable this by setting the optional parameter `"return_redacted_no_speech_audio": true` within `redact_pii_audio_options` in your `POST` request body.

<Accordion title="Example request body">
```json
{
    "audio_url": "YOUR_AUDIO_URL",
    "redact_pii": true,
    "redact_pii_audio": true,
    "redact_pii_audio_options": {
          "return_redacted_no_speech_audio": true
     },
     "redact_pii_policies": ["credit_card_number"]
}
```
</Accordion>

</Info>

### Example output

```plain
https://s3.us-west-2.amazonaws.com/api.assembly.ai.usw2/redacted-audio/ac06721c-d1ea-41a7-95f7-a9463421e6b1.mp3?AWSAccessKeyId=...
```

## API reference

### Request

```bash {6-10}
curl https://api.assemblyai.com/v2/transcript \
--header "Authorization: <YOUR_API_KEY>" \
--header "Content-Type: application/json" \
--data '{
  "audio_url": "YOUR_AUDIO_URL",
  "redact_pii": true,
  "redact_pii_policies": ["us_social_security_number", "credit_card_number"],
  "redact_pii_sub": "hash",
  "redact_pii_audio": true,
  "redact_pii_audio_quality": "mp3"
}'
```

| Key                        | Type    | Description                                                                      |
| -------------------------- | ------- | -------------------------------------------------------------------------------- |
| `redact_pii`               | boolean | Enable PII Redaction.                                                            |
| `redact_pii_policies`      | array   | [PII policies](#pii-policies) for what information to redact.                    |
| `redact_pii_sub`           | string  | Method used to substitute PII in the transcript. Can be `entity_name` or `hash`. |
| `redact_pii_audio`         | boolean | Create a [redacted version of the audio file](#create-redacted-audio-files).     |
| `redact_pii_audio_quality` | string  | Quality of the redacted PII audio file. Can be `mp3` or `wav`.                   |

### Response

<Markdown src="pii-redaction-response.mdx" />

| Key    | Type   | Description                   |
| ------ | ------ | ----------------------------- |
| `text` | string | Transcript with redacted PII. |

The response also includes the request parameters used to generate the transcript.

### Request for Redacted Audio

In the request URL, replace transcript_id with the ID of the transcript where `redact_pii_audio` is set to `true`.

```bash {6-10}
curl https://api.assemblyai.com/v2/transcript/transcript_id/redacted-audio \
--header "Authorization: <YOUR_API_KEY>"
```

### Response for Redacted Audio

<Markdown src="pii-redacted-audio-response.mdx" />

| Key                  | Type   | Description                         |
| -------------------- | ------ | ----------------------------------- |
| `status`             | string | The status of the redacted audio.   |
| `redacted_audio_url` | string | The URL of the redacted audio file. |

### PII policies

| Policy name                 | Description                                                                                                    | Example                                                          |
| --------------------------- | -------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------- |
| `account_number`            | Customer account or membership identification number                                                           | `Policy No. 10042992; Member ID: HZ-5235-001`                    |
| `banking_information`       | Banking information, including account and routing numbers                                                     |                                                                  |
| `blood_type`                | Blood type                                                                                                     | O-, AB positive                                                  |
| `credit_card_cvv`           | Credit card verification code                                                                                  | CVV: 080                                                         |
| `credit_card_expiration`    | Expiration date of a credit card                                                                               |                                                                  |
| `credit_card_number`        | Credit card number                                                                                             |                                                                  |
| `date`                      | Specific calendar date                                                                                         | December 18                                                      |
| `date_of_birth`             | Date of birth                                                                                                  | Date of Birth: March 7, 1961                                     |
| `drivers_license`           | Driver's license number                                                                                        | DL# 356933-540                                                   |
| `drug`                      | Medications, vitamins, or supplements                                                                          | Advil, Acetaminophen, Panadol                                    |
| `email_address`             | Email address                                                                                                  | support@assemblyai.com                                           |
| `event`                     | Name of an event or holiday                                                                                    | Olympics, Yom Kippur                                             |
| `gender_sexuality`          | Terms indicating gender identity or sexual orientation, including slang terms                                  | female, bisexual, trans                                          |
| `healthcare_number`         | Healthcare numbers and health plan beneficiary numbers                                                         | Policy No.: 5584-486-674-YM                                      |
| `injury`                    | Bodily injury                                                                                                  | I broke my arm, I have a sprained wrist                          |
| `ip_address`                | Internet IP address, including IPv4 and IPv6 formats                                                           | 192.168.0.1                                                      |
| `language`                  | Name of a natural language                                                                                     | Spanish, French                                                  |
| `location`                  | Any Location reference including mailing address, postal code, city, state, province, country, or coordinates. | Lake Victoria, 145 Windsor St., 90210                            |
| `medical_condition`         | Name of a medical condition, disease, syndrome, deficit, or disorder                                           | chronic fatigue syndrome, arrhythmia, depression                 |
| `medical_process`           | Medical process, including treatments, procedures, and tests                                                   | heart surgery, CT scan                                           |
| `money_amount`              | Name and/or amount of currency                                                                                 | 15 pesos, $94.50                                                 |
| `nationality`               | Terms indicating nationality, ethnicity, or race                                                               | American, Asian, Caucasian                                       |
| `number_sequence`           | Numerical PII (including alphanumeric strings) that doesn't fall under other categories                        |                                                                  |
| `occupation`                | Job title or profession                                                                                        | professor, actors, engineer, CPA                                 |
| `organization`              | Name of an organization                                                                                        | CNN, McDonalds, University of Alaska, Northwest General Hospital |
| `passport_number`           | Passport numbers, issued by any country                                                                        | PA4568332, NU3C6L86S12                                           |
| `password`                  | Account passwords, PINs, access keys, or verification answers                                                  | 27%alfalfa, temp1234, My mother's maiden name is Smith           |
| `person_age`                | Number associated with an age                                                                                  | 27, 75                                                           |
| `person_name`               | Name of a person                                                                                               | Bob, Doug Jones, Dr. Kay Martinez, MD                            |
| `phone_number`              | Telephone or fax number                                                                                        |                                                                  |
| `political_affiliation`     | Terms referring to a political party, movement, or ideology                                                    | Republican, Liberal                                              |
| `religion`                  | Terms indicating religious affiliation                                                                         | Hindu, Catholic                                                  |
| `url`                       | Internet addresses                                                                                             | https://www.assemblyai.com/                                      |
| `us_social_security_number` | Social Security Number or equivalent                                                                           |                                                                  |
| `username`                  | Usernames, login names, or handles                                                                             | @AssemblyAI                                                      |
| `vehicle_id`                | Vehicle identification numbers (VINs), vehicle serial numbers, and license plate numbers                       | 5FNRL38918B111818, BIF7547                                       |

## Troubleshooting

<Accordion
  title="Why is the PII not redacted in my transcription?"
  theme="dark"
  iconColor="white"
>
  Make sure that at least one [PII policy](#pii-policies) has been specified in
  your request, using the `redact_pii_policies` parameter. If you're still
  experiencing issues, please reach out to our support team for assistance.
</Accordion>
<Accordion
  title="Why is my webhook not being sent?"
  theme="dark"
  iconColor="white"
>
  There could be several reasons why your webhook isn't being sent, such as a
  misconfigured URL, an unreachable endpoint, or an issue with the
  authentication headers. Double-check your request and ensure that the{" "}
  `webhook_url` parameter is included with a valid URL that can be reached by
  AssemblyAI's API. If you're using custom authentication headers, ensure that
  the `webhook_auth_header_name` and `webhook_auth_header_value` parameters are
  included and are correct. If you're still having issues, please contact our
  support team for assistance.
</Accordion>
<Accordion
  title="Why does my redacted audio file sound worse than the original?"
  theme="dark"
  iconColor="white"
>
  By default, the API returns redacted audio files in MP3 format, a lossy
  format. Lossy formats remove audio information to reduce file size, which may
  cause a reduction in quality. The difference may be particularly noticeable if
  the submitted audio is in a lossless file format. To retain as much quality as
  possible, you can instead return your redacted audio files in a lossless
  format, by setting `redact_pii_audio_quality` to `wav`.
</Accordion>
