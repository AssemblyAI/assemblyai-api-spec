---
title: 'Automatic Language Detection: Route to Default Language if Language Confidence is Low'
---



# Automatic Language Detection: Route to Default Language if Language Confidence is Low

This guide will show you how to use AssemblyAI's API to resubmit a request using a default language if the Automatic Language Detection's `language_confidence` is below a certain threshold. The following code uses the JavaScript SDK. Prefer Python? [Here is the same code using the Python SDK](automatic-language-detection-route-default-language-python.ipynb)!

## Get Started

Before we begin, make sure you have an AssemblyAI account and an API key. You can [sign up for an AssemblyAI account](https://www.assemblyai.com/app) and get your API key from your dashboard.

## Step-by-Step Instructions

Install the SDK:

```js
npm install assemblyai
```

Import the `assemblyai` package and set the API key.

```js
import { AssemblyAI } from 'assemblyai';

const client = new AssemblyAI({
    apiKey: 'YOUR_API_KEY' 
});
```

Define a `default_language`, which should be set to the [language code](https://www.assemblyai.com/docs/getting-started/supported-languages) that will be used to rerun the transcript if language detection runs with low `language_confidence`.

```js
const default_language = 'LANGUAGE_CODE';
```

Define an `audio_url` that is set to a link to the audio file. Define and set the parameters `audio: audioUrl` and `language_detection: true`. We also need to define our `language_confidence_threshold`. For the purposes of this example, we'll set it to 0.8, representing 80% confidence.

If a transcript ends up with a `language_confidence` below this value, the transcript will error out and will return the transcript using the `default_language`.  

```js
const audioUrl = 'https://example.org/audio.mp3';

const params = {
    audio: audioUrl,
    language_detection: true,
    language_confidence_threshold: 0.8,
    // Add any other params
};
```

Define a function called `run`. Within this function create a transcript using the set params. If there is no error, then the transcript ID and text of the original transcript will be printed. If there is an error with the transcript, it will check if it is a `language_confidence` related error message. If this is true, a message will be printed saying that the transcript is being rerun. The transcript then is run again with the `language_code` set to the `default_language`, and the transcript ID and text of the new transcript are both printed. This new transcript will use the original params except `language_detection` will be turned off, `language_confidence_threshold` will be set to `null`, and the `language_code` will be set to the `default_language`. Once it is finished, the new transcript ID and text will be printed.

NOTE: You will not be charged for the first transcript if there is an error. You will only be charged for the transcript that processes successfully.

```js
const run = async (params) => {

    const transcript = await client.transcripts.transcribe(params);

    if (transcript.status === 'error') {
        if (transcript.error.includes("below the requested confidence threshold value")) {
            console.log(
                `${transcript.error}. Running transcript again with language set to '${default_language}'.`
            );
            params = {...params, language_detection: false, language_confidence_threshold: null, language_code: default_language};
            run(params);
            return;
        }

        console.log(transcript.error);
        return;
    }

    console.log(`Transcript ID: ${transcript.id}`);
    console.log(transcript.text);
};

run(params);
```
